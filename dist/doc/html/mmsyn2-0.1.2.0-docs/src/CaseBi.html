<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">CaseBi</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- * Function that can be used instead of </span><span>
</span><a name="line-5"></a><span class="hs-comment">--</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- &gt; case var of </span><span>
</span><a name="line-7"></a><span class="hs-comment">-- &gt;   a1 -&gt; b1</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- &gt;   a2 -&gt; b2</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- &gt;   a3 -&gt; b3</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- &gt;   ...</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- &gt;   an -&gt; bn</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- &gt;   _  -&gt; def</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- </span><span>
</span><a name="line-14"></a><span class="hs-comment">-- for efficiency</span><span>
</span><a name="line-15"></a><span>  </span><a href="CaseBi.html#getBFst%27"><span class="hs-identifier hs-var">getBFst'</span></a><span class="hs-special">,</span><span> </span><a href="CaseBi.html#getBFst"><span class="hs-identifier hs-var">getBFst</span></a><span class="hs-special">,</span><span> </span><a href="CaseBi.html#getBFstV"><span class="hs-identifier hs-var">getBFstV</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- * Additional functions that are used to sort a list of pairs (which can be obtained by e. g. Prelude.zip)</span><span>
</span><a name="line-17"></a><span>  </span><a href="CaseBi.html#sortFst"><span class="hs-identifier hs-var">sortFst</span></a><span class="hs-special">,</span><span> </span><a href="CaseBi.html#sortFstV"><span class="hs-identifier hs-var">sortFstV</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- ** Function that can be used for changing the Vector (a, b) during its creation </span><span>
</span><a name="line-19"></a><span>  </span><a href="CaseBi.html#filterP"><span class="hs-identifier hs-var">filterP</span></a><span>
</span><a name="line-20"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Vector</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">V</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span class="hs-special">,</span><span class="hs-identifier hs-var">head</span><span class="hs-special">,</span><span class="hs-identifier hs-var">last</span><span class="hs-special">,</span><span class="hs-identifier hs-var">take</span><span class="hs-special">,</span><span class="hs-identifier hs-var">drop</span><span class="hs-special">,</span><span class="hs-identifier hs-var">length</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier hs-var">fromList</span><span class="hs-special">,</span><span class="hs-identifier hs-var">map</span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">groupBy</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- (Bool,Eq,Ord,map,(&gt;=),(&lt;=),(&gt;),(&lt;),(==),(&amp;&amp;),(.),(++),(-),($),filter,otherwise,fst,snd,div,not,null,dropWhile,concatMap,take,seq,undefined)</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-comment">-- | The function that can be used instead of the 'case ... of' function</span><span>
</span><a name="line-28"></a><span class="hs-comment">--</span><span>
</span><a name="line-29"></a><span class="hs-comment">-- &gt; case var of</span><span>
</span><a name="line-30"></a><span class="hs-comment">-- &gt;   a1 -&gt; b1</span><span>
</span><a name="line-31"></a><span class="hs-comment">-- &gt;   a2 -&gt; b2</span><span>
</span><a name="line-32"></a><span class="hs-comment">-- &gt;   a3 -&gt; b3</span><span>
</span><a name="line-33"></a><span class="hs-comment">-- &gt;   ...</span><span>
</span><a name="line-34"></a><span class="hs-comment">-- &gt;   an -&gt; bn</span><span>
</span><a name="line-35"></a><span class="hs-comment">-- &gt;   _  -&gt; defaultValue</span><span>
</span><a name="line-36"></a><span class="hs-comment">-- </span><span>
</span><a name="line-37"></a><span class="hs-comment">-- The function 'case a of ...' gives the /O(n)/ coplexity of the transformation of a to b here, </span><span>
</span><a name="line-38"></a><span class="hs-comment">-- but the function getBFst' tries to give about /O(log n)/ complexity </span><span>
</span><a name="line-39"></a><span class="hs-comment">-- The Vector v (a, b) must be sorted in ascending order here for the algorithm to be used correctly. For this you can use </span><span>
</span><a name="line-40"></a><span class="hs-comment">-- the following functions 'sortFst' and 'sortFstV'. </span><span>
</span><a name="line-41"></a><span class="hs-comment">-- </span><span>
</span><a name="line-42"></a><span class="hs-comment">-- b before Vector (a, b) in the type definition of the 'getBFst' must be a @defaultValue@ for 'case' above. </span><span>
</span><a name="line-43"></a><span class="hs-comment">--</span><span>
</span><a name="line-44"></a><span class="hs-comment">-- Vector (a, b) corresponds to </span><span>
</span><a name="line-45"></a><span class="hs-comment">--</span><span>
</span><a name="line-46"></a><span class="hs-comment">-- &gt;  a1 -&gt; b1</span><span>
</span><a name="line-47"></a><span class="hs-comment">-- &gt;  a2 -&gt; b2</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- &gt;  a3 -&gt; b3</span><span>
</span><a name="line-49"></a><span class="hs-comment">-- &gt;  ...</span><span>
</span><a name="line-50"></a><span class="hs-comment">-- &gt;  an -&gt; bn</span><span>
</span><a name="line-51"></a><span class="hs-comment">-- </span><span>
</span><a name="line-52"></a><span class="hs-identifier">getBFst'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627399317"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627399318"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-comment">-- ^ a default value that can be substituted if there is no correspendence in the set of (a, b) tuples (the 'otherwise' or irrefutable pattern analogue)</span><span>
</span><a name="line-53"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">V.Vector</span><span> </span><span class="hs-special">(</span><a href="#local-1627399317"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627399318"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Vector of the (a, b) tuples that must be sorted in ascending order for the first argument. If there are several pairs (a, b) with the same a, the function gives a resulting b as if there is only the first one</span><span>
</span><a name="line-54"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627399317"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ an element for which the corresponding resulting b must be found</span><span>
</span><a name="line-55"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627399318"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-comment">-- ^ the result</span><span>
</span><a name="line-56"></a><a name="getBFst%27"><a href="CaseBi.html#getBFst%27"><span class="hs-identifier">getBFst'</span></a></a><span> </span><a name="local-1627399319"><a href="#local-1627399319"><span class="hs-identifier">def</span></a></a><span> </span><a name="local-1627399320"><a href="#local-1627399320"><span class="hs-identifier">vec</span></a></a><span> </span><a name="local-1627399321"><a href="#local-1627399321"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-1627399321"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-1627399322"><span class="hs-identifier hs-var">vElem0</span></a><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-1627399321"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-1627399324"><span class="hs-identifier hs-var">vElemL</span></a><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627399319"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-57"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-1627399325"><span class="hs-identifier hs-var">vIL</span></a><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1627399321"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-special">(</span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span> </span><span class="hs-operator hs-var">V.!</span><span> </span><span class="hs-special">(</span><a href="#local-1627399325"><span class="hs-identifier hs-var">vIL</span></a><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span>  </span><span class="hs-keyword">then</span><span> </span><a href="CaseBi.html#getBFst%27"><span class="hs-identifier hs-var">getBFst'</span></a><span> </span><a href="#local-1627399319"><span class="hs-identifier hs-var">def</span></a><span> </span><a href="#local-1627399326"><span class="hs-identifier hs-var">v1</span></a><span> </span><a href="#local-1627399321"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-59"></a><span>  </span><span class="hs-keyword">else</span><span> </span><a href="CaseBi.html#getBFst%27"><span class="hs-identifier hs-var">getBFst'</span></a><span> </span><a href="#local-1627399319"><span class="hs-identifier hs-var">def</span></a><span> </span><a href="#local-1627399327"><span class="hs-identifier hs-var">v2</span></a><span> </span><a href="#local-1627399321"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-60"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-1627399325"><span class="hs-identifier hs-var">vIL</span></a><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1627399321"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1627399322"><span class="hs-identifier hs-var">vElem0</span></a><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span>
</span><a name="line-61"></a><span>  </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.head</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span>
</span><a name="line-62"></a><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1627399321"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1627399323"><span class="hs-identifier hs-var">vElem1</span></a><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span>
</span><a name="line-63"></a><span>         </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span> </span><span class="hs-operator hs-var">V.!</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-64"></a><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1627399321"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1627399324"><span class="hs-identifier hs-var">vElemL</span></a><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span>
</span><a name="line-65"></a><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.last</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span>
</span><a name="line-66"></a><span>                </span><span class="hs-keyword">else</span><span> </span><a href="#local-1627399319"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-67"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-1627399325"><span class="hs-identifier hs-var">vIL</span></a><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1627399321"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1627399322"><span class="hs-identifier hs-var">vElem0</span></a><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span>
</span><a name="line-68"></a><span>  </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.head</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span>
</span><a name="line-69"></a><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1627399321"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1627399324"><span class="hs-identifier hs-var">vElemL</span></a><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span>
</span><a name="line-70"></a><span>         </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.last</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span>
</span><a name="line-71"></a><span>         </span><span class="hs-keyword">else</span><span> </span><a href="#local-1627399319"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-72"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-1627399325"><span class="hs-identifier hs-var">vIL</span></a><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.head</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span>
</span><a name="line-73"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627399319"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-74"></a><span>            </span><span class="hs-keyword">where</span><span> </span><a name="local-1627399322"><a href="#local-1627399322"><span class="hs-identifier">vElem0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.head</span><span>
</span><a name="line-75"></a><span>                  </span><a name="local-1627399323"><a href="#local-1627399323"><span class="hs-identifier">vElem1</span></a></a><span> </span><a name="local-1627399344"><a href="#local-1627399344"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627399344"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">V.!</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-76"></a><span>                  </span><a name="local-1627399324"><a href="#local-1627399324"><span class="hs-identifier">vElemL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.last</span><span>
</span><a name="line-77"></a><span>                  </span><a name="local-1627399325"><a href="#local-1627399325"><span class="hs-identifier">vIL</span></a></a><span> </span><a name="local-1627399345"><a href="#local-1627399345"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.length</span><span> </span><a href="#local-1627399345"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-78"></a><span>                  </span><a name="local-1627399326"><a href="#local-1627399326"><span class="hs-identifier">v1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.take</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.length</span><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span>
</span><a name="line-79"></a><span>                  </span><a name="local-1627399327"><a href="#local-1627399327"><span class="hs-identifier">v2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.drop</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.length</span><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><a href="#local-1627399320"><span class="hs-identifier hs-var">vec</span></a><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">-- | The function that uses special kind of bisection to effectively transform the Vector a to Vector b with  instead of simply use </span><span>
</span><a name="line-82"></a><span class="hs-comment">--</span><span>
</span><a name="line-83"></a><span class="hs-comment">-- &gt; case var of</span><span>
</span><a name="line-84"></a><span class="hs-comment">-- &gt;   a1 -&gt; b1</span><span>
</span><a name="line-85"></a><span class="hs-comment">-- &gt;   a2 -&gt; b2</span><span>
</span><a name="line-86"></a><span class="hs-comment">-- &gt;   a3 -&gt; b3</span><span>
</span><a name="line-87"></a><span class="hs-comment">-- &gt;   ...</span><span>
</span><a name="line-88"></a><span class="hs-comment">-- &gt;   an -&gt; bn</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- &gt;   _  -&gt; defaultValue</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- </span><span>
</span><a name="line-91"></a><span class="hs-comment">-- The function 'V.map (f (case var of ...)) [a]' gives the /O(n*m)/ coplexity of the transformation of Vector a to Vector b here </span><span>
</span><a name="line-92"></a><span class="hs-comment">-- where m is the length of the Vector a (and Vector b respectively here), but the function 'getBFstV' tries to give about /O(m*log n)/ complexity </span><span>
</span><a name="line-93"></a><span class="hs-comment">-- The Vector (a, b) must be sorted in ascending order here for the algorithm to be used correctly. For this you can use </span><span>
</span><a name="line-94"></a><span class="hs-comment">-- the following functions 'sortFst' and 'sortFstV'. If m &gt;&gt; n than the function gives more efficiency. Even otherwise, </span><span>
</span><a name="line-95"></a><span class="hs-comment">-- it can be used to simplify the procedure for optimizing the code for transformation of the Vector data.</span><span>
</span><a name="line-96"></a><span class="hs-comment">-- </span><span>
</span><a name="line-97"></a><span class="hs-comment">-- b after Vector (a, b) in the type definition of the 'getBFstV' must be a defaultValue for case above. </span><span>
</span><a name="line-98"></a><span class="hs-comment">--</span><span>
</span><a name="line-99"></a><span class="hs-comment">-- Vector (a, b) corresponds to </span><span>
</span><a name="line-100"></a><span class="hs-comment">--</span><span>
</span><a name="line-101"></a><span class="hs-comment">-- &gt;  a1 -&gt; b1</span><span>
</span><a name="line-102"></a><span class="hs-comment">-- &gt;  a2 -&gt; b2</span><span>
</span><a name="line-103"></a><span class="hs-comment">-- &gt;  a3 -&gt; b3</span><span>
</span><a name="line-104"></a><span class="hs-comment">-- &gt;  ...</span><span>
</span><a name="line-105"></a><span class="hs-comment">-- &gt;  an -&gt; bn</span><span>
</span><a name="line-106"></a><span class="hs-comment">-- </span><span>
</span><a name="line-107"></a><span class="hs-identifier">getBFstV</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627399315"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">V.Vector</span><span> </span><span class="hs-special">(</span><a href="#local-1627399315"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627399316"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Vector of the (a, b) tuples that are sorted in ascending order for the first argument</span><span>
</span><a name="line-108"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627399316"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-comment">-- ^ a default value that can be substituted if there is no correspendence in the set of (a, b) tuples (the 'otherwise' or irrefutable pattern analogue)</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">V.Vector</span><span> </span><a href="#local-1627399315"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ a Vector needed to be transformed accordingly to the correct (a, b) tuple pairs</span><span>
</span><a name="line-110"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">V.Vector</span><span> </span><a href="#local-1627399316"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-comment">-- ^ the resulting Vector</span><span>
</span><a name="line-111"></a><a name="getBFstV"><a href="CaseBi.html#getBFstV"><span class="hs-identifier">getBFstV</span></a></a><span> </span><a name="local-1627399984"><a href="#local-1627399984"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-1627399985"><a href="#local-1627399985"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><a href="CaseBi.html#getBFst%27"><span class="hs-identifier hs-var">getBFst'</span></a><span> </span><a href="#local-1627399985"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-1627399984"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-comment">-- | The function that uses special kind of bisection to effectively transform the [a] to [b] with  instead of simply use </span><span>
</span><a name="line-114"></a><span class="hs-comment">--</span><span>
</span><a name="line-115"></a><span class="hs-comment">-- &gt; case var of</span><span>
</span><a name="line-116"></a><span class="hs-comment">-- &gt;   a1 -&gt; b1</span><span>
</span><a name="line-117"></a><span class="hs-comment">-- &gt;   a2 -&gt; b2</span><span>
</span><a name="line-118"></a><span class="hs-comment">-- &gt;   a3 -&gt; b3</span><span>
</span><a name="line-119"></a><span class="hs-comment">-- &gt;   ...</span><span>
</span><a name="line-120"></a><span class="hs-comment">-- &gt;   an -&gt; bn</span><span>
</span><a name="line-121"></a><span class="hs-comment">-- &gt;   _  -&gt; defaultValue</span><span>
</span><a name="line-122"></a><span class="hs-comment">-- </span><span>
</span><a name="line-123"></a><span class="hs-comment">-- The function 'map (f (case var of ...)) [a]' gives the /O(n*m)/ coplexity of the transformation of [a] to [b] here </span><span>
</span><a name="line-124"></a><span class="hs-comment">-- where m is the length of the [a] (and [b] respectively here), but the function 'getBFst' tries to give about /O(m*log n)/ complexity </span><span>
</span><a name="line-125"></a><span class="hs-comment">-- The Vector (a, b) must be sorted in ascending order here for the algorithm to be used correctly. For this you can use </span><span>
</span><a name="line-126"></a><span class="hs-comment">-- the following functions 'sortFst' and 'sortFstV'. If m &gt;&gt; n than the function gives more efficiency. Even otherwise, </span><span>
</span><a name="line-127"></a><span class="hs-comment">-- it can be used to simplify the procedure for optimizing the code for transformation of the list data.</span><span>
</span><a name="line-128"></a><span class="hs-comment">-- </span><span>
</span><a name="line-129"></a><span class="hs-comment">-- b after Vector (a, b) in the type definition of the 'getBFst' must be a defaultValue for 'case' above. </span><span>
</span><a name="line-130"></a><span class="hs-comment">--</span><span>
</span><a name="line-131"></a><span class="hs-comment">-- Vector (a, b) corresponds to </span><span>
</span><a name="line-132"></a><span class="hs-comment">--</span><span>
</span><a name="line-133"></a><span class="hs-comment">-- &gt;  a1 -&gt; b1</span><span>
</span><a name="line-134"></a><span class="hs-comment">-- &gt;  a2 -&gt; b2</span><span>
</span><a name="line-135"></a><span class="hs-comment">-- &gt;  a3 -&gt; b3</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- &gt;  ...</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- &gt;  an -&gt; bn</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- </span><span>
</span><a name="line-139"></a><span class="hs-identifier">getBFst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627399313"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">V.Vector</span><span> </span><span class="hs-special">(</span><a href="#local-1627399313"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627399314"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Vector of the (a, b) tuples that must be sorted in ascending order for the first argument</span><span>
</span><a name="line-140"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627399314"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-comment">-- ^ a default value that can be substituted if there is no correspendence in the set of (a, b) tuples (the 'otherwise' or irrefutable pattern analogue)</span><span>
</span><a name="line-141"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627399313"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ a list of values needed to be transformed accordingly to the correct (a, b) tuple pairs</span><span>
</span><a name="line-142"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627399314"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ the resulting list</span><span>
</span><a name="line-143"></a><a name="getBFst"><a href="CaseBi.html#getBFst"><span class="hs-identifier">getBFst</span></a></a><span> </span><a name="local-1627399986"><a href="#local-1627399986"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-1627399987"><a href="#local-1627399987"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="CaseBi.html#getBFst%27"><span class="hs-identifier hs-var">getBFst'</span></a><span> </span><a href="#local-1627399987"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-1627399986"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-comment">-- | Function that sorts a list of (a, b) tuples by the first argument (@a@ must be an instance of class Ord)</span><span>
</span><a name="line-146"></a><span class="hs-comment">-- and is inspired by Data.List.sort function (the last one can be used for sorting the (a, b) tuples where both the types of a and b</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- have instances of the class Ord). It is inspired by the work: https://wiki.haskell.org/Introduction</span><span>
</span><a name="line-148"></a><span class="hs-identifier">sortFst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627399311"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627399311"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627399312"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627399311"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627399312"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-149"></a><a name="sortFst"><a href="CaseBi.html#sortFst"><span class="hs-identifier">sortFst</span></a></a><span> </span><a name="local-1627399988"><a href="#local-1627399988"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627399988"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1627401049"><a href="#local-1627401049"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627399988"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="CaseBi.html#sortFst"><span class="hs-identifier hs-var">sortFst</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-1627401250"><a href="#local-1627401250"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627401250"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-1627401049"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627399988"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-1627401251"><a href="#local-1627401251"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627401251"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1627401049"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627399988"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="CaseBi.html#sortFst"><span class="hs-identifier hs-var">sortFst</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-1627401252"><a href="#local-1627401252"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627401252"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-1627401049"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627399988"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">-- | Function that prepares the list of (a, b) tuples representing the </span><span>
</span><a name="line-153"></a><span class="hs-comment">--</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- &gt; case var of </span><span>
</span><a name="line-155"></a><span class="hs-comment">-- &gt;   a1 -&gt; b1</span><span>
</span><a name="line-156"></a><span class="hs-comment">-- &gt;   a2 -&gt; b2</span><span>
</span><a name="line-157"></a><span class="hs-comment">-- &gt;   a3 -&gt; b3</span><span>
</span><a name="line-158"></a><span class="hs-comment">-- &gt;    ...</span><span>
</span><a name="line-159"></a><span class="hs-comment">-- &gt;   an -&gt; bn</span><span>
</span><a name="line-160"></a><span class="hs-comment">-- &gt;   _  -&gt; defaultValue</span><span>
</span><a name="line-161"></a><span class="hs-comment">--</span><span>
</span><a name="line-162"></a><span class="hs-comment">-- for usage in the 'getBFst' and 'getBFstV' functions. @a@ must be an instance of class Ord.</span><span>
</span><a name="line-163"></a><span class="hs-comment">--</span><span>
</span><a name="line-164"></a><span class="hs-identifier">sortFstV</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627399309"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627399309"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627399310"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">V.Vector</span><span> </span><span class="hs-special">(</span><a href="#local-1627399309"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627399310"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-165"></a><a name="sortFstV"><a href="CaseBi.html#sortFstV"><span class="hs-identifier">sortFstV</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="CaseBi.html#sortFst"><span class="hs-identifier hs-var">sortFst</span></a><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span class="hs-comment">-- | The function that is used to filter a list [(a, b)] of the corresponding values for getFstB' to obtain the Vector (a, b) </span><span>
</span><a name="line-168"></a><span class="hs-comment">-- such that the b element for the sequence of pairs (a, b) with the same a is selected by the predicate p and is not necessarily the first one </span><span>
</span><a name="line-169"></a><span class="hs-comment">-- as it is for the getFstB' function and its successors by default.</span><span>
</span><a name="line-170"></a><span class="hs-identifier">filterP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627393585"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-1627393585"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627393586"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ The predicate p used to select the only one value of b in the pairs (a, b) with the same a. </span><span>
</span><a name="line-171"></a><span>  </span><span class="hs-comment">-- ^ If there are several pairs (a, b) for the same a that satisfies a predicate then the first one is used. For large [(a, b)] </span><span>
</span><a name="line-172"></a><span>  </span><span class="hs-comment">-- ^ it can be rather complex.</span><span>
</span><a name="line-173"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627393585"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627393586"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ The list of (a, b) sorted in the ascending order by the first element a (e. g. by the 'sortFst' function)</span><span>
</span><a name="line-174"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">V.Vector</span><span> </span><span class="hs-special">(</span><a href="#local-1627393585"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627393586"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ The resulting filtered Vector (a, b) that can be used for getFstB' and its successor functions</span><span>
</span><a name="line-175"></a><span class="hs-comment">--</span><span>
</span><a name="line-176"></a><span class="hs-comment">-- Example: </span><span>
</span><a name="line-177"></a><span class="hs-comment">--</span><span>
</span><a name="line-178"></a><span class="hs-comment">-- &gt; filterP (\(t, w) -&gt; (t == &quot;1&quot;) || (w &gt; 'f')) . sortFst $ [(&quot;1&quot;,'a'),(&quot;4a&quot;,'k'),(&quot;4a&quot;,'b'),(&quot;4a&quot;,'c'),(&quot;4a&quot;,'d'),(&quot;4a&quot;,'e'),(&quot;b7&quot;,'c'),(&quot;b7&quot;,'k')] = [(&quot;1&quot;,'a'),(&quot;4a&quot;,'k'),(&quot;b7&quot;,'k')]</span><span>
</span><a name="line-179"></a><span class="hs-comment">-- </span><span>
</span><a name="line-180"></a><a name="filterP"><a href="CaseBi.html#filterP"><span class="hs-identifier">filterP</span></a></a><span> </span><a name="local-1627401253"><a href="#local-1627401253"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-1627401254"><a href="#local-1627401254"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627401255"><a href="#local-1627401255"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-1627401253"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627401255"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L.groupBy</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-1627401411"><a href="#local-1627401411"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-1627401412"><a href="#local-1627401412"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627401411"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1627401412"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627401254"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a></pre></body></html>